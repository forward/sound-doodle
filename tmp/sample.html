<html>
  <head>
    <script src="http://wami.csail.mit.edu/wami-2.0.js?prettyPrint=true"> </script>

    <script>
    var myWamiApp; 
    function onLoad() {
        // JSGF grammar for your application
      var jsgf = 
        "#JSGF V1.0;\n" +
        "grammar parrot;\n" +
        "public <top> = hello wami | i want a cracker | feed me;\n";

        var grammar = {
                    language : "en-gb", 
                    grammar : jsgf
            };

        // Handlers are functions which are called for various events:
        var options = {
              guiID : 'AudioContainer',
              devKey : '1b8de6c0863f6e4615602d04d8f47def',
              grammar : grammar,
              onReady : onWamiReady, //WAMI is loaded and ready
              onRecognition : onWamiRecognitionResult,  //Speech recognition result available
        onError : onWamiError,  //An error occurred
        onTimeout : onWamiTimeout
            }; //WAMI timed out due to inactivity

        //Create your WAMI application with the settings and grammar we just created
        myWamiApp = new Wami.App(options);
    }

    function onWamiReady() {
      //Called when your WAMI application is ready.  You might wait until now
      //to tell the user it's time to start interacting
    }

    //called when a speech recognition result is received
    //since we set sendIncrementalResults to false, this will only
    //be called after the user finishes speaking.  Otherwise,
    //it will be called many times as the user speaks.
    function onWamiRecognitionResult(result) {
      var hyp = result.text();  //what we think the user said
      alert("You said: '" + hyp + "'"); 
      myWamiApp.speak(hyp); //Speech synthesis of what we heard
      setTimeout("myWamiApp.playback()", 500); //play back audio we recorded
    }

    //called when an error occurs
    function onWamiError(type, message) {
      alert("WAMI error: type  = " + type + ", message = " + message);  
    }

    //called when your WAMI session times out due to
    //in activity.
    function onWamiTimeout() {
      alert("WAMI timed out.  Hit reload to start over");
    }

    </script>
  </head>

  <body onload="onLoad()">
    <div id="AudioContainer">
    </div>
  </body>
</html>